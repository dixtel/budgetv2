(()=>{var _={headers:{},mergeStrategy:"replace",transitions:!1,mapDelimiter:":"},F=()=>{console.error(`You can't use the "morph" merge without first installing the Alpine "morph" plugin here: https://alpinejs.dev/plugins/morph`)};function b(e){e.morph&&(F=e.morph),e.addInitSelector(()=>`[${e.prefixed("target")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.push")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.replace")}]`),e.directive("target",(a,{value:o,modifiers:t,expression:n},{evaluateLater:u,effect:c})=>{let d=l=>{a._ajax_target=a._ajax_target||{};let h={ids:C(a,l),sync:!0,focus:!t.includes("nofocus"),history:t.includes("push")?"push":t.includes("replace")?"replace":!1},s=t.filter(m=>m==="error"||parseInt(m));s=s.length?s:["xxx"],s.forEach(m=>{m.charAt(0)==="3"&&(m="3xx"),a._ajax_target[m]=h})};if(o==="dynamic"){let l=u(n);c(()=>l(d))}else d(n)}),e.directive("headers",(a,{expression:o},{evaluateLater:t,effect:n})=>{let u=t(o||"{}");n(()=>{u(c=>{a._ajax_headers=c})})}),e.addInitSelector(()=>`[${e.prefixed("merge")}]`),e.directive("merge",(a,{value:o,modifiers:t,expression:n},{evaluateLater:u,effect:c})=>{let d=l=>{a._ajax_strategy=l,a._ajax_transition=_.transitions||t.includes("transition")};if(o==="dynamic"){let l=u(n);c(()=>l(d))}else d(n)}),e.magic("ajax",a=>async(o,t={})=>{let n={el:a,target:{xxx:{ids:C(a,t.targets||t.target),sync:!!t.sync,history:"history"in t?t.history:!1,focus:"focus"in t?t.focus:!0}},headers:t.headers||{}},u=t.method?t.method.toUpperCase():"GET",c=t.body;return E(n,o,u,c)});let r=!1;e.ajax={start(){r||(document.addEventListener("submit",I),document.addEventListener("click",D),window.addEventListener("popstate",T),r=!0)},stop(){document.removeEventListener("submit",I),document.removeEventListener("click",D),window.removeEventListener("popstate",T),r=!1}},e.ajax.start()}b.configure=e=>(_=Object.assign(_,e),b);var $=b;function T(e){!e.state||!e.state.__ajax||window.location.reload(!0)}async function D(e){if(e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=e?.target.closest("a[href]:not([download]):not([noajax])");if(!r||!r._ajax_target||r.isContentEditable||r.origin!==window.location.origin||r.getAttribute("href").startsWith("#")||M(r,window.location)&&r.hash)return;e.preventDefault(),e.stopImmediatePropagation();let a={el:r,target:r._ajax_target,headers:r._ajax_headers||{}},o=r.getAttribute("href");try{return await E(a,o)}catch(t){if(t.name==="RenderError"){console.warn(t.message),window.location.href=r.href;return}throw t}}async function I(e){if(e.defaultPrevented)return;let r=e.target,a=e.submitter,o=(a?.getAttribute("formmethod")||r.getAttribute("method")||"GET").toUpperCase();if(!r||!r._ajax_target||o==="DIALOG"||a?.hasAttribute("formnoajax")||a?.hasAttribute("formtarget")||r.hasAttribute("noajax")||r.hasAttribute("target"))return;e.preventDefault(),e.stopImmediatePropagation();let t={el:r,target:r._ajax_target,headers:r._ajax_headers||{}},n=new FormData(r),u=r.getAttribute("enctype"),c=r.getAttribute("action");a&&(u=a.getAttribute("formenctype")||u,c=a.getAttribute("formaction")||c,a.name&&n.append(a.name,a.value));try{return await G(a,()=>E(t,c,o,n,u))}catch(d){if(d.name==="RenderError"){console.warn(d.message),r.setAttribute("noajax","true"),r.requestSubmit(a);return}throw d}}async function G(e,r){if(!e)return await r();let a=t=>t.preventDefault();e.setAttribute("aria-disabled","true"),e.addEventListener("click",a);let o;try{o=await r()}finally{e.removeAttribute("aria-disabled"),e.removeEventListener("click",a)}return o}var p=new Map;async function E(e,r="",a="GET",o=null,t="application/x-www-form-urlencoded"){if(!f(e.el,"ajax:before"))return;let n=e.target.xxx,u=new AbortController,c=L(n,u),d=e.el.closest("[data-source]")?.dataset.source||window.location.href,l={action:r||d,method:a,body:o?N(o):null,enctype:t,referrer:d,signal:u.signal,headers:Object.assign({"X-Alpine-Request":!0,"X-Alpine-Target":c.map(i=>i._ajax_id).join(" ")},_.headers,e.headers)};f(e.el,"ajax:send",l),l.body&&(l.method==="GET"?(l.action=B(l.body,l.action),l.body=null):l.enctype!=="multipart/form-data"&&(l.body=P(l.body)));let h;a==="GET"&&p.has(l.action)?h=p.get(l.action):(h=fetch(l.action,l).then(async i=>{let x=await i.text(),y=document.createRange().createContextualFragment("<template>"+x+"</template>");return i.html=y.firstElementChild.content,i.raw=x,i}),p.set(l.action,h));let s;try{s=await h}catch(i){if(i.name!=="AbortError")throw i;return}if(s.ok?(s.redirected&&(f(e.el,"ajax:redirect",s),p.set(s.url,h),setTimeout(()=>{p.delete(s.url)},5)),f(e.el,"ajax:success",s)):f(e.el,"ajax:error",s),f(e.el,"ajax:sent",s),!s.html){c.forEach(i=>i._ajax_abort());return}let m=s.redirected?"3xx":s.status.toString(),O=[m,m.charAt(0)+"xx",s.ok?"xxx":"error","xxx"].find(i=>i in e.target);n=e.target[O],(!n.ids.flat().includes("_self")||!s.redirected||!M(new URL(s.url),window.location))&&(c.forEach(i=>i._ajax_abort()),c=L(n,u)),n.history&&K(n.history,s.url);let g=!n.focus,U=c.map(async i=>{if(i._ajax_id==="_none"||(i===document.documentElement&&(window.location.href=s.url),!document.body.contains(i)))return;let x=s.html.getElementById(i._ajax_id);if(!x){if(i._ajax_sync||!f(e.el,"ajax:missing",{target:i,response:s}))return;if(s.ok)return i.remove();throw new j(i,s.status)}let y=async()=>{if(i=await H(i,x),i){i.dataset.source=s.url,i._ajax_abort&&i._ajax_abort();let v=["[x-autofocus]","[autofocus]"];for(;!g&&v.length;){let S=v.shift();i.matches(S)&&(g=k(i)),g=g||Array.from(i.querySelectorAll(S)).some(q=>k(q))}}return f(i,"ajax:merged"),i};if(f(i,"ajax:merge",{strategy:i._ajax_strategy,content:x,merge:y}))return y()});p.delete(l.action);let A=await Promise.all(U);return f(e.el,"ajax:after",{response:s,render:A}),A}function L(e,r){let a=t=>(t._ajax_strategy=t._ajax_strategy||_.mergeStrategy,t._ajax_transition=t._ajax_transition&&document.startViewTransition,t._ajax_abort&&t._ajax_abort(),t.querySelectorAll("[aria-busy]").forEach(n=>{n._ajax_abort&&n._ajax_abort()}),t.setAttribute("aria-busy","true"),t._ajax_abort=()=>{t.removeAttribute("aria-busy"),r.abort()},t),o=e.ids.map(t=>{let n=t[0],u=["_self","_top","_none"].includes(n)?document.documentElement:document.getElementById(n);if(!u){console.warn(`Target [#${n}] was not found in current document.`);return}let c=a(u);return c._ajax_id=t[1],c}).filter(t=>t);return e.sync&&document.querySelectorAll("[x-sync]").forEach(t=>{let n=t.getAttribute("id");if(!n)throw new w(t);let u=a(t);u._ajax_id=n,u._ajax_sync=!0,o.push(u)}),o}function N(e){if(e instanceof FormData)return e;if(e instanceof HTMLFormElement)return new FormData(e);let r=new FormData;for(let a in e)typeof e[a]=="object"?r.append(a,JSON.stringify(e[a])):r.append(a,e[a]);return r}function B(e,r){return r=new URL(r,document.baseURI),r.search=P(e).toString(),r.toString()}function P(e){let r=Array.from(e.entries()).filter(([a,o])=>!(o instanceof File));return new URLSearchParams(r)}async function H(e,r){let a={before(t,n){return t.before(...n.childNodes),t},replace(t,n){return t.replaceWith(n),n},update(t,n){return t.replaceChildren(...n.childNodes),t},prepend(t,n){return t.prepend(...n.childNodes),t},append(t,n){return t.append(...n.childNodes),t},after(t,n){return t.after(...n.childNodes),t},morph(t,n){return F(t,n),document.getElementById(n.getAttribute("id"))}};return e._ajax_transition?(await document.startViewTransition(()=>(e=a[e._ajax_strategy](e,r),Promise.resolve())).updateCallbackDone,e):a[e._ajax_strategy](e,r)}function k(e){return!e||!e.getClientRects().length?!1:(setTimeout(()=>{e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.focus()},0),!0)}function K(e,r){return{push:()=>window.history.pushState({__ajax:!0},"",r),replace:()=>window.history.replaceState({__ajax:!0},"",r)}[e]()}function C(e,r=null){let a=e.getAttribute("id"),o=[a];if(r&&(o=Array.isArray(r)?r:r.split(" ")),o=o.filter(t=>t).map(t=>{let n=t.split(_.mapDelimiter).map(u=>u||a);return n[1]=n[1]||n[0],n}),o.length===0)throw new w(e);return o}function f(e,r,a){return e.dispatchEvent(new CustomEvent(r,{detail:a,bubbles:!0,composed:!0,cancelable:!0}))}function M(e,r){return R(e.pathname)+e.search===R(r.pathname)+r.search}function R(e){return e.replace(/\/$/,"")}var w=class extends DOMException{constructor(r){let a=(r.outerHTML.match(/<[^>]+>/)??[])[0]??"[Element]";super(`${a} is missing an ID to target.`,"IDError")}},j=class extends DOMException{constructor(r,a){let o=r.getAttribute("id");super(`Target [#${o}] was not found in response with status [${a}].`,"RenderError")}};document.addEventListener("alpine:initializing",()=>{$(window.Alpine)});})();
